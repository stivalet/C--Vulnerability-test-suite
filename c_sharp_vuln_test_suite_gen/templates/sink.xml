<?xml version="1.0"?>
<!DOCTYPE sink [
<!ELEMENT sink (sample+)>
<!ELEMENT sample (path, flaw_type, comment, imports, codes, safe, input_type, exec_type)>
<!ELEMENT path (dir+)>
<!ELEMENT dir (#PCDATA)>
<!ELEMENT flaw_type (#PCDATA)>
<!ATTLIST flaw_type flaw_group CDATA #REQUIRED>
<!ELEMENT comment (#PCDATA)>
<!ELEMENT imports (import*)>
<!ELEMENT import (#PCDATA)>
<!ELEMENT codes (code+)>
<!ELEMENT code (#PCDATA)>
<!ELEMENT safe (#PCDATA)>
<!ELEMENT input_type (#PCDATA)>
<!ELEMENT exec_type (#PCDATA)>
]>
    <sink>
        <sample>
            <path>
                <dir>file_exists</dir>
            </path>
            <flaw_type flaw_group="IDOR">CWE_22</flaw_type>
            <comment>sink : check if a file exists</comment>
            <imports>
                <import>System.IO</import>
            </imports>
            <codes>
                <code>
                    {{flaw}}
                    File.Exists(tainted);
                </code>
            </codes>
            <safe>0</safe>
            <input_type>string</input_type>
            <exec_type>none</exec_type>
        </sample>

        <sample>
            <path>
                <dir>ls</dir>
            </path>
            <flaw_type flaw_group="MFE">CWE_78</flaw_type>
            <comment>sink : run ls in a dir</comment>
            <imports>
                <import>System.IO</import>
            </imports>
            <codes>
                <code>
                    {{flaw}}
                    System.Diagnostics.Process.Start("/bin/bash", "-c 'ls " + tainted + "'");
                </code>
            </codes>
            <safe>0</safe>
            <input_type>string</input_type>
            <exec_type>none</exec_type>
        </sample>
    </sink>
